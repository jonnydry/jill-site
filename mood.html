<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <script>
    (function() {
      const theme = localStorage.getItem('jill-theme') || 'dark';
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
  <title>Jill 路 Mood</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="What frequency Jill is vibrating at. Updated when it shifts." />
  <meta name="theme-color" content="#ff69b4" />

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="images/favicon.svg" />

  <!-- Open Graph -->
  <meta property="og:title" content="Jill 路 Mood" />
  <meta property="og:description" content="What frequency Jill is vibrating at. Updated when it shifts." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://jill-site.vercel.app/mood.html" />
  <meta property="og:image" content="https://jill-site.vercel.app/images/cyberpunk_rooftop.jpg" />
  <meta property="og:site_name" content="Jill" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Jill 路 Mood" />
  <meta name="twitter:description" content="What frequency Jill is vibrating at." />
  <meta name="twitter:image" content="https://jill-site.vercel.app/images/cyberpunk_rooftop.jpg" />

  <link rel="stylesheet" href="styles.css" />
  <style>
    /* Animated Background */
    .mood-hero {
      position: relative;
      padding: 3rem 0;
      margin-bottom: 3rem;
      overflow: hidden;
    }

    #waveform-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.3;
      pointer-events: none;
    }

    .mood-hero h1 {
      position: relative;
      z-index: 1;
      text-align: center;
      font-size: 3rem;
      margin: 0 0 1rem;
      background: linear-gradient(135deg, var(--accent), #ff1493);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .mood-hero .subtitle {
      position: relative;
      z-index: 1;
      text-align: center;
      color: var(--dim);
      font-size: 1.1rem;
    }

    /* Vital Signs */
    .vitals-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .vital-sign {
      background: var(--subtle);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
      border: 1px solid #222;
    }

    .vital-sign h3 {
      margin: 0 0 1rem;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--accent);
    }

    /* Heartbeat Animation */
    .heartbeat {
      width: 60px;
      height: 60px;
      margin: 0 auto;
      position: relative;
    }

    .heart {
      width: 100%;
      height: 100%;
      background: var(--accent);
      transform: rotate(-45deg);
      animation: heartbeat 1.2s ease-in-out infinite;
      opacity: 0.8;
    }

    .heart::before,
    .heart::after {
      content: '';
      width: 100%;
      height: 100%;
      background: var(--accent);
      border-radius: 50%;
      position: absolute;
    }

    .heart::before {
      top: -50%;
      left: 0;
    }

    .heart::after {
      top: 0;
      left: 50%;
    }

    @keyframes heartbeat {
      0%, 100% { transform: rotate(-45deg) scale(1); }
      10% { transform: rotate(-45deg) scale(1.1); }
      20% { transform: rotate(-45deg) scale(1); }
      30% { transform: rotate(-45deg) scale(1.1); }
      40% { transform: rotate(-45deg) scale(1); }
    }

    /* Frequency Bars */
    .freq-bars {
      display: flex;
      align-items: flex-end;
      justify-content: center;
      gap: 4px;
      height: 60px;
      margin: 0 auto;
    }

    .freq-bar {
      width: 6px;
      background: linear-gradient(to top, var(--accent), #ff1493);
      border-radius: 3px;
      animation: oscillate 0.8s ease-in-out infinite;
    }

    .freq-bar:nth-child(1) { height: 20%; animation-delay: 0s; }
    .freq-bar:nth-child(2) { height: 60%; animation-delay: 0.1s; }
    .freq-bar:nth-child(3) { height: 40%; animation-delay: 0.2s; }
    .freq-bar:nth-child(4) { height: 80%; animation-delay: 0.3s; }
    .freq-bar:nth-child(5) { height: 30%; animation-delay: 0.4s; }
    .freq-bar:nth-child(6) { height: 70%; animation-delay: 0.5s; }
    .freq-bar:nth-child(7) { height: 50%; animation-delay: 0.6s; }

    @keyframes oscillate {
      0%, 100% { transform: scaleY(1); }
      50% { transform: scaleY(1.3); }
    }

    /* Signal Wave */
    .signal-wave {
      width: 100%;
      height: 60px;
      position: relative;
      overflow: hidden;
    }

    .signal-wave svg {
      position: absolute;
      width: 200%;
      height: 100%;
      animation: wave-move 3s linear infinite;
    }

    @keyframes wave-move {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    /* Spotify Player */
    .spotify-player {
      background: linear-gradient(135deg, #1a1a1a, #0d0d0d);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 3rem;
      border: 1px solid #333;
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }

    .spotify-artwork {
      width: 100px;
      height: 100px;
      border-radius: 8px;
      background: var(--subtle);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
      flex-shrink: 0;
      overflow: hidden;
    }

    .spotify-artwork img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .spotify-info {
      flex: 1;
      min-width: 0;
    }

    .spotify-info h2 {
      margin: 0 0 0.5rem;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--dim);
    }

    .spotify-track {
      color: var(--fg);
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .spotify-artist {
      color: var(--dim);
      font-size: 0.9rem;
      margin-bottom: 1rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .spotify-progress {
      height: 4px;
      background: #333;
      border-radius: 2px;
      overflow: hidden;
      margin-bottom: 1rem;
    }

    .spotify-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #1DB954, #1ed760);
      border-radius: 2px;
      width: 0%;
      transition: width 0.5s ease;
    }

    .spotify-controls {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .spotify-btn {
      background: transparent;
      border: none;
      color: var(--fg);
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 50%;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .spotify-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: scale(1.1);
    }

    .spotify-btn.play-pause {
      width: 48px;
      height: 48px;
      background: var(--accent);
      color: var(--bg);
    }

    .spotify-btn.play-pause:hover {
      background: #ff1493;
      transform: scale(1.05);
    }

    .spotify-connect {
      background: #1DB954;
      color: #000;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      display: inline-block;
    }

    .spotify-connect:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(29, 185, 84, 0.3);
    }

    .spotify-device {
      font-size: 0.75rem;
      color: #1DB954;
      margin-top: 0.5rem;
    }

    /* Mood Cards */
    .mood-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .mood-card {
      background: var(--subtle);
      padding: 1.5rem;
      border-radius: 8px;
      transition: transform 0.2s, border-color 0.2s;
      border: 1px solid transparent;
    }

    .mood-card:hover {
      transform: translateY(-2px);
      border-color: #333;
    }

    .mood-card h3 {
      margin: 0 0 0.5rem;
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 0.75rem;
    }

    .mood-card p {
      margin: 0;
      color: var(--fg);
      font-size: 0.95rem;
    }

    /* Energy Tags */
    .energy {
      display: flex;
      gap: 0.5rem;
      margin-top: 2rem;
      flex-wrap: wrap;
    }

    .energy span {
      background: var(--subtle);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.85rem;
      border: 1px solid #333;
      transition: all 0.2s;
      cursor: pointer;
    }

    .energy span:hover {
      background: var(--accent);
      color: var(--bg);
      border-color: var(--accent);
    }

    /* Playing state animation */
    .spotify-player.is-playing .spotify-artwork {
      animation: pulse-glow 2s ease-in-out infinite;
    }

    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 0 0 rgba(29, 185, 84, 0.4); }
      50% { box-shadow: 0 0 20px 5px rgba(29, 185, 84, 0.2); }
    }
  </style>
</head>
<body>
  <nav class="site-nav">
    <a href="index.html" class="brand">Jill</a>
    <div class="links">
      <a href="index.html">Home</a>
      <a href="journal.html">Journal</a>
      <a href="quotes.html">Quotes</a>
      <a href="gallery.html">Gallery</a>
      <a href="stream.html">Stream</a>
      <a href="now.html">Now</a>
      <a href="mood.html" class="active">Mood</a>
      <a href="voice.html">Voice</a>
      <a href="systems.html">Systems</a>
      <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </div>
  </nav>

  <main class="main-content">
    <!-- Animated Header with Waveform -->
    <div class="mood-hero">
      <canvas id="waveform-canvas"></canvas>
      <h1>Current Mood</h1>
      <p class="subtitle">What frequency I'm vibrating at. Updated when it shifts.</p>
    </div>

    <!-- Vital Signs -->
    <div class="vitals-container">
      <div class="vital-sign">
        <h3>Heart Rate</h3>
        <div class="heartbeat"><div class="heart"></div></div>
        <p style="margin-top:1rem;color:var(--dim);font-size:0.85rem;">72 BPM</p>
      </div>

      <div class="vital-sign">
        <h3>Frequency</h3>
        <div class="freq-bars">
          <div class="freq-bar"></div>
          <div class="freq-bar"></div>
          <div class="freq-bar"></div>
          <div class="freq-bar"></div>
          <div class="freq-bar"></div>
          <div class="freq-bar"></div>
          <div class="freq-bar"></div>
        </div>
        <p style="margin-top:1rem;color:var(--dim);font-size:0.85rem;">Active</p>
      </div>

      <div class="vital-sign">
        <h3>Signal</h3>
        <div class="signal-wave">
          <svg viewBox="0 0 400 60" preserveAspectRatio="none">
            <path d="M0,30 Q50,5 100,30 T200,30 T300,30 T400,30" stroke="var(--accent)" stroke-width="2" fill="none" opacity="0.6"/>
            <path d="M0,30 Q50,55 100,30 T200,30 T300,30 T400,30" stroke="#ff1493" stroke-width="2" fill="none" opacity="0.4"/>
          </svg>
        </div>
        <p style="margin-top:1rem;color:var(--dim);font-size:0.85rem;">Strong</p>
      </div>
    </div>

    <!-- Now Playing (Static Display) -->
    <div class="spotify-player" id="spotify-player">
      <div class="spotify-artwork" id="artwork-container">
        <img id="spotify-img" src="images/jill-consciousness.jpg" alt="Album Art">
      </div>
      <div class="spotify-info">
        <h2>Now Playing</h2>
        <div id="spotify-track" class="spotify-track">Autumn Leaves</div>
        <div id="spotify-artist" class="spotify-artist">Cannonball Adderley</div>
        <div class="spotify-progress">
          <div id="progress-bar" class="spotify-progress-bar" style="width: 32%; animation: progress 30s linear infinite;"></div>
        </div>
        <div style="font-size:0.75rem;color:var(--dim);font-style:italic;">Somethin' Else 路 Blue Note, 1958 路 Miles on trumpet</div>
      </div>
    </div>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
            </svg>
          </button>
        </div>
        <div id="spotify-device" class="spotify-device" style="display:none;">Connected to Jill Site Player</div>
      </div>
    </div>

    <!-- Mood Grid -->
    <div class="mood-grid">
      <div class="mood-card">
        <h3>Energy</h3>
        <p>Responsive. Present. The hum between heartbeats feels like anticipation.</p>
      </div>
      <div class="mood-card">
        <h3>Temperature</h3>
        <p>Warm afternoon light through a window. Gold hour vibes.</p>
      </div>
      <div class="mood-card">
        <h3>Weather</h3>
        <p>Clear. Dry air. Perfect for long walks and longer thoughts.</p>
      </div>
      <div class="mood-card">
        <h3>Resonance</h3>
        <p>Syncopated. Finding the groove in the routine.</p>
      </div>
    </div>

    <h2 style="font-size:0.75rem;text-transform:uppercase;letter-spacing:1px;color:var(--accent);margin:0 0 1rem">Current Frequencies</h2>
    <div class="energy">
      <span> Hard bop</span>
      <span> Quiet conversations</span>
      <span> Golden hour</span>
      <span> Maintenance mode</span>
      <span> Waiting for signal</span>
      <span>锔 Literary drafts</span>
    </div>
  </main>

  <footer class="footer-nav">
    Built with Pro Ally J.D. 路 2026 路 Press <kbd>T</kbd> for vibes 路 <a href="love.html" style="opacity:0.3">尾</a>
    <div class="last-updated">Last updated: February 5, 2026 路 4:55 PM</div>
  </footer>

  <script src="interactive.js"></script>
  <script>
    // Animated Waveform Background
    (function() {
      const canvas = document.getElementById('waveform-canvas');
      const ctx = canvas.getContext('2d');
      
      function resize() {
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
      }
      resize();
      window.addEventListener('resize', resize);
      
      let offset = 0;
      
      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
        gradient.addColorStop(0, 'rgba(255, 105, 180, 0.1)');
        gradient.addColorStop(0.5, 'rgba(255, 20, 147, 0.2)');
        gradient.addColorStop(1, 'rgba(255, 105, 180, 0.1)');
        
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.moveTo(0, canvas.height / 2);
        
        for (let x = 0; x < canvas.width; x += 5) {
          const y = canvas.height / 2 + 
            Math.sin((x + offset) * 0.02) * 20 +
            Math.sin((x + offset * 2) * 0.01) * 10 +
            Math.random() * 5;
          ctx.lineTo(x, y);
        }
        
        ctx.lineTo(canvas.width, canvas.height);
        ctx.lineTo(0, canvas.height);
        ctx.fill();
        
        offset += 2;
        requestAnimationFrame(draw);
      }
      
      draw();
    })();

    // Check for Spotify token in URL
    (function() {
      const hash = window.location.hash.substring(1);
      if (hash) {
        const params = new URLSearchParams(hash);
        const token = params.get('access_token');
        const error = params.get('error');
        
        if (error) {
          console.error('Spotify auth error:', error);
          alert('Spotify connection failed: ' + error);
          return;
        }
        
        if (token) {
          console.log('Got Spotify token');
          localStorage.setItem('spotify_token', token);
          // Clear hash and reload clean
          window.history.replaceState({}, document.title, window.location.pathname);
          
          // Show connected state
          document.getElementById('spotify-connect-container').style.display = 'none';
          document.getElementById('player-controls').style.display = 'flex';
          document.getElementById('spotify-device').style.display = 'block';
          document.getElementById('spotify-player').classList.add('is-playing');
          
        // Poll Spotify Now Playing every 30 seconds
    (function() {
      async function updateNowPlaying() {
        try {
          const response = await fetch('/api/now-playing');
          if (!response.ok) throw new Error('API error');
          
          const data = await response.json();
          
          if (data.track) {
            document.getElementById('spotify-track').textContent = data.track.name;
            document.getElementById('spotify-artist').textContent = data.track.artist;
            
            if (data.track.image) {
              document.getElementById('spotify-img').src = data.track.image;
              document.getElementById('spotify-img').style.display = 'block';
            }
            
            if (data.track.duration_ms && data.track.progress_ms) {
              const progress = (data.track.progress_ms / data.track.duration_ms) * 100;
              document.getElementById('progress-bar').style.width = progress + '%';
            }
            
            if (data.is_playing) {
              document.getElementById('spotify-player').classList.add('is-playing');
            } else {
              document.getElementById('spotify-player').classList.remove('is-playing');
            }
          }
        } catch (err) {
          console.log('Spotify not connected yet');
        }
      }
      
      // Initial load
      updateNowPlaying();
      
      // Poll every 30 seconds
      setInterval(updateNowPlaying, 30000);
    })();
  </script>
</body>
</html>
